<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vector Forge - React Edition</title>
    
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { sans: ['Inter', 'sans-serif'] },
                    colors: { 
                        darkBase: '#000000', 
                        glassCard: 'rgba(28, 28, 30, 0.65)', 
                        brandBlue: '#0A84FF', /* Apple Official Blue */
                        brandGreen: '#30D158',
                        brandRed: '#FF453A'
                    },
                    animation: { 
                        'pop-in': 'popIn 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards',
                        'pop-out': 'popOut 0.5s ease-in forwards',
                        'fade-up': 'fadeUp 0.5s ease-out',
                        'spin-slow': 'spin 8s linear infinite' 
                    },
                    keyframes: { 
                        popIn: { '0%': { transform: 'translateY(-150%) scale(0.5)', opacity: '0' }, '100%': { transform: 'translateY(0) scale(1)', opacity: '1' } },
                        popOut: { '0%': { transform: 'translateY(0) scale(1)', opacity: '1' }, '100%': { transform: 'translateY(-150%) scale(0.5)', opacity: '0' } },
                        fadeUp: { '0%': { opacity: '0', transform: 'translateY(20px)' }, '100%': { opacity: '1', transform: 'translateY(0)' } }
                    }
                }
            }
        }
    </script>
    <style>
        /* Wallpaper Abstrak Keren Pilihan User */
        body {
            background: url('https://4kwallpapers.com/images/wallpapers/ios-18-stock-6016x3384-15344.jpg') no-repeat center center fixed; 
            background-size: cover;
        }
        /* Scrollbar Halus */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.2); border-radius: 10px; }
    </style>
</head>
<body class="text-slate-200 min-h-screen selection:bg-brandBlue selection:text-white">

    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        function App() {
            // --- STATE MANAGEMENT ---
            const [apiKey, setApiKey] = useState('');
            const [status, setStatus] = useState('OFFLINE'); 
            const [powerLevel, setPowerLevel] = useState(2); 
            const [config, setConfig] = useState({ category: 'Social Media Set', quantity: 1 });
            const [prompts, setPrompts] = useState([]);
            const [isGenerating, setIsGenerating] = useState(false);
            
            // State untuk Notifikasi
            const [showNotif, setShowNotif] = useState(false);
            const [notifClosing, setNotifClosing] = useState(false);
            
            const resultsRef = useRef(null);

            // --- 1. LOGIKA NOTIFIKASI (AUTO HILANG 5 DETIK) ---
            useEffect(() => {
                let timer;
                if (showNotif) {
                    setNotifClosing(false);
                    timer = setTimeout(() => {
                        handleCloseNotif();
                    }, 5000); // 5000ms = 5 detik
                }
                return () => clearTimeout(timer);
            }, [showNotif]);

            const handleCloseNotif = () => {
                setNotifClosing(true);
                setTimeout(() => setShowNotif(false), 500); // Tunggu animasi selesai
            };

            // --- 2. LOGIKA API KEY ---
            useEffect(() => {
                const savedKey = localStorage.getItem('groqKey');
                if (savedKey) { setApiKey(savedKey); validateKey(savedKey); }
            }, []);

            const handleKeyChange = (e) => {
                const val = e.target.value;
                setApiKey(val); validateKey(val);
                if(val.startsWith('gsk_')) localStorage.setItem('groqKey', val);
            };

            const validateKey = (key) => {
                setStatus(key.trim().startsWith('gsk_') ? 'ONLINE' : 'OFFLINE');
            };

            // --- 3. STRATEGI MODEL (3 LEVEL) ---
            const getModelStrategy = (level) => {
                switch(parseInt(level)) {
                    case 1: return { model: 'llama-3.1-8b-instant', desc: 'FAST', system: 'Create SIMPLE, FLAT vector prompts.' };
                    case 2: return { model: 'llama-3.3-70b-versatile', desc: 'PRO', system: 'Create DETAILED, COMMERCIAL vector prompts.' };
                    case 3: return { model: 'llama-3.3-70b-versatile', desc: 'ULTRA', system: 'Create HYPER-DETAILED, PREMIUM vector prompts with lighting.' };
                    default: return { model: 'llama-3.3-70b-versatile', desc: 'PRO', system: '' };
                }
            };

            // --- 4. GENERATE PROMPT ---
            const generatePrompts = async () => {
                if (status === 'OFFLINE') return;
                setIsGenerating(true);
                setShowNotif(false); 
                setPrompts([]);

                const strategy = getModelStrategy(powerLevel);
                const requests = [];

                for (let i = 0; i < config.quantity; i++) {
                    const seed = Math.floor(Math.random() * 999999);
                    let userContent = `Create Vector Sticker Sheet Prompt for: ${config.category}. 
                    Mandatory: White Background, Knolling Layout. Seed: ${seed}`;

                    requests.push(
                        fetch("https://api.groq.com/openai/v1/chat/completions", {
                            method: "POST",
                            headers: { "Authorization": `Bearer ${apiKey}`, "Content-Type": "application/json" },
                            body: JSON.stringify({
                                model: strategy.model,
                                messages: [{ role: "system", content: strategy.system }, { role: "user", content: userContent }],
                                temperature: powerLevel === 3 ? 0.85 : 0.7,
                                max_tokens: 500
                            })
                        }).then(r => r.json())
                    );
                }

                try {
                    const results = await Promise.all(requests);
                    const newPrompts = results.map((data) => {
                        if(data.error) return "Error: " + data.error.message;
                        let text = data.choices[0].message.content.replace(/"/g, "");
                        return text + " --v 6.0 --no text watermark realistic shading";
                    });
                    setPrompts(newPrompts);
                    setShowNotif(true);
                } catch (err) { alert("Error: " + err.message); } 
                finally { setIsGenerating(false); }
            };

            const scrollToResults = () => {
                resultsRef.current?.scrollIntoView({ behavior: 'smooth' });
                handleCloseNotif();
            };

            const copyText = (text, idx) => {
                navigator.clipboard.writeText(text);
                const btn = document.getElementById(`btn-copy-${idx}`);
                const originalText = btn.innerHTML;
                btn.innerHTML = `<i class="fa-solid fa-check"></i> Disalin`;
                btn.classList.add("bg-brandGreen", "text-white");
                setTimeout(() => {
                    btn.innerHTML = originalText;
                    btn.classList.remove("bg-brandGreen", "text-white");
                }, 2000);
            };

            return (
                <div className="relative min-h-screen p-4 flex justify-center items-start pt-10 md:pt-20">
                    
                    {/* NOTIFIKASI DINAMIS (Dynamic Island Style) */}
                    {showNotif && (
                        <div 
                            onClick={scrollToResults}
                            className={`fixed top-6 z-50 bg-black border border-white/10 text-white px-6 py-3 rounded-[30px] shadow-2xl cursor-pointer flex items-center gap-3 backdrop-blur-xl ${notifClosing ? 'animate-pop-out' : 'animate-pop-in'}`}
                        >
                            <div className="w-8 h-8 bg-brandGreen rounded-full flex items-center justify-center text-black text-sm">
                                <i className="fa-solid fa-check"></i>
                            </div>
                            <div className="flex flex-col">
                                <span className="text-[10px] font-bold text-gray-400 uppercase tracking-wide">Selesai</span>
                                <span className="text-sm font-semibold">Hasil Siap! Tap di sini</span>
                            </div>
                        </div>
                    )}

                    <div className="w-full max-w-6xl grid grid-cols-1 md:grid-cols-12 gap-6 md:gap-10">
                        
                        {/* PANEL KIRI (CONTROLS) */}
                        <div className="md:col-span-4 lg:col-span-4">
                            <div className="bg-glassCard/80 backdrop-blur-xl border border-white/10 p-6 rounded-[32px] shadow-2xl sticky top-10 overflow-hidden">
                                
                                <div className="mb-8">
                                    {/* JUDUL DENGAN WARNA PREMIUM APPLE STYLE (Titanium/Silver Gradient) */}
                                    <h1 className="text-3xl font-bold tracking-tight mb-1 bg-clip-text text-transparent bg-gradient-to-br from-white via-slate-200 to-slate-400">
                                        Vector Forge
                                    </h1>
                                    <p className="text-sm text-gray-400 font-medium">React Powered Engine</p>
                                </div>

                                <div className="space-y-4 mb-8">
                                    <div className="space-y-2">
                                        <label className="text-[10px] font-bold text-gray-500 uppercase tracking-widest ml-1">Groq API Key</label>
                                        <div className="relative">
                                            <input 
                                                type="password" value={apiKey} onChange={handleKeyChange} placeholder="gsk_..." 
                                                className="w-full bg-black/30 border border-white/5 rounded-2xl px-4 py-3 text-sm focus:border-brandBlue focus:ring-1 focus:ring-brandBlue outline-none transition"
                                            />
                                            <div className="absolute right-3 top-3 text-gray-500">
                                                <i className="fa-solid fa-key"></i>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div className={`w-full py-2.5 rounded-xl text-center font-bold text-xs tracking-wide transition-all ${status === 'ONLINE' ? 'bg-brandGreen/20 text-brandGreen border border-brandGreen/30' : 'bg-brandRed/20 text-brandRed border border-brandRed/30'}`}>
                                        {status === 'ONLINE' ? 'SISTEM ONLINE' : 'OFFLINE / NO KEY'}
                                    </div>
                                </div>

                                <div className="mb-8 space-y-2">
                                    <label className="text-[10px] font-bold text-gray-500 uppercase tracking-widest ml-1">Power Level</label>
                                    <div className="bg-black/30 p-1 rounded-2xl grid grid-cols-3 gap-1">
                                        {[1, 2, 3].map((level) => {
                                            const info = getModelStrategy(level);
                                            return (
                                                <button
                                                    key={level}
                                                    onClick={() => setPowerLevel(level)}
                                                    className={`py-2 rounded-xl text-xs font-semibold transition-all duration-300 ${
                                                        powerLevel === level 
                                                        ? 'bg-gray-600 text-white shadow-lg' 
                                                        : 'text-gray-400 hover:text-white'
                                                    }`}
                                                >
                                                    <span className="block mb-0.5">LVL {level}</span>
                                                    <span className="text-[9px] opacity-70 font-normal">{info.desc}</span>
                                                </button>
                                            )
                                        })}
                                    </div>
                                </div>

                                <div className="space-y-5 mb-8">
                                    <div className="space-y-2">
                                        <label className="text-[10px] font-bold text-gray-500 uppercase tracking-widest ml-1">Kategori</label>
                                        <div className="relative">
                                            <select 
                                                value={config.category} onChange={(e) => setConfig({...config, category: e.target.value})}
                                                className="w-full bg-black/30 border border-white/5 rounded-2xl px-4 py-3 text-sm appearance-none outline-none focus:border-brandBlue"
                                            >
                                                <option>Social Media Set</option>
                                                <option>Business Icons</option>
                                                <option>Cute Characters</option>
                                                <option>Futuristic Tech</option>
                                                <option>Floral Patterns</option>
                                            </select>
                                            <div className="absolute right-4 top-3.5 text-gray-400 pointer-events-none text-xs">
                                                <i className="fa-solid fa-chevron-down"></i>
                                            </div>
                                        </div>
                                    </div>

                                    <div className="space-y-2">
                                        <div className="flex justify-between px-1">
                                            <label className="text-[10px] font-bold text-gray-500 uppercase tracking-widest">Jumlah Prompt</label>
                                            <span className="text-xs font-bold text-brandBlue">{config.quantity}</span>
                                        </div>
                                        <input 
                                            type="range" min="1" max="5" value={config.quantity}
                                            onChange={(e) => setConfig({...config, quantity: parseInt(e.target.value)})}
                                            className="w-full h-1.5 bg-gray-700 rounded-lg appearance-none cursor-pointer accent-brandBlue"
                                        />
                                    </div>
                                </div>

                                <button 
                                    onClick={generatePrompts}
                                    disabled={status === 'OFFLINE' || isGenerating}
                                    className={`w-full py-4 rounded-2xl font-bold text-[15px] text-white shadow-xl transition-all active:scale-95 ${
                                        status === 'OFFLINE' || isGenerating
                                        ? 'bg-gray-700 cursor-not-allowed opacity-50'
                                        : 'bg-brandBlue hover:bg-blue-600'
                                    }`}
                                >
                                    {isGenerating ? (
                                        <span className="flex items-center justify-center gap-2"><i className="fa-solid fa-circle-notch fa-spin"></i> Processing...</span>
                                    ) : (
                                        <span className="flex items-center justify-center gap-2"><i className="fa-solid fa-bolt"></i> Generate</span>
                                    )}
                                </button>
                            </div>
                        </div>

                        {/* PANEL KANAN (HASIL) */}
                        <div className="md:col-span-8 lg:col-span-8">
                            <div ref={resultsRef} className="space-y-4 min-h-[500px]">
                                {prompts.length === 0 ? (
                                    <div className="h-full flex flex-col items-center justify-center bg-glassCard/30 backdrop-blur-md rounded-[32px] border border-white/5 p-10 text-center">
                                        <div className="w-24 h-24 bg-white/5 rounded-full flex items-center justify-center mb-6 animate-pulse">
                                            {/* LOGO REACT MUTER */}
                                            <i className="fa-brands fa-react text-5xl text-brandBlue animate-spin-slow"></i>
                                        </div>
                                        <h3 className="text-xl font-bold text-white mb-2">React Engine Ready</h3>
                                        <p className="text-sm text-gray-400 max-w-xs leading-relaxed">Menunggu perintah untuk meracik prompt vektor berkualitas tinggi.</p>
                                    </div>
                                ) : (
                                    prompts.map((prompt, idx) => (
                                        <div key={idx} className="bg-glassCard/80 backdrop-blur-xl border border-white/10 rounded-[28px] p-6 animate-fade-up hover:bg-glassCard transition group">
                                            
                                            <div className="flex justify-between items-center mb-4 pb-4 border-b border-white/5">
                                                <div className="flex items-center gap-3">
                                                    <span className="text-[10px] font-bold bg-white/10 text-white px-3 py-1.5 rounded-full uppercase tracking-wider">
                                                        #{idx + 1}
                                                    </span>
                                                    <span className={`text-[10px] font-bold px-2 py-1 rounded text-gray-400 uppercase`}>
                                                        {getModelStrategy(powerLevel).desc}
                                                    </span>
                                                </div>
                                                {/* ICON REACT KECIL DI CARD */}
                                                <i className="fa-brands fa-react text-gray-600 text-lg"></i>
                                            </div>
                                            
                                            <div className="bg-black/40 p-5 rounded-2xl font-mono text-[13px] text-gray-300 leading-relaxed mb-6 select-all border border-white/5">
                                                {prompt}
                                            </div>

                                            <div className="flex justify-end">
                                                <button 
                                                    id={`btn-copy-${idx}`}
                                                    onClick={() => copyText(prompt, idx)}
                                                    className="bg-white/10 hover:bg-white text-white hover:text-black px-5 py-2.5 rounded-xl text-xs font-bold transition-all flex items-center gap-2 group-hover:shadow-lg"
                                                >
                                                    <i className="fa-regular fa-copy"></i> Copy Prompt
                                                </button>
                                            </div>
                                        </div>
                                    ))
                                )}
                            </div>
                        </div>

                    </div>
                    
                    <div className="fixed bottom-4 right-4 text-[10px] text-white/20 font-mono">
                        Powered by React & Groq
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
